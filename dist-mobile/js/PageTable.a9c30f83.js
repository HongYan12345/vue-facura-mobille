import{P as Y,r as j,t as X,e as E,u as G,c as H,I as J,a as R,o as K,O as Q,N as W,h as Z,j as u,k as m,l as f,p as l,q as a,w as t,v as d,y,F as O,s as p,X as S,Y as $,x as oo,A as eo,B as ao}from"./index.f87cd9a6.js";const to={components:{PlusOutlined:Y},setup(){const o=j({total:0,iva:0,re:0,total_euros:0,dto:0,ante_euro:0,isRe:!1,isIva:!1,add_producto:!1,cantidad:"",codigo:"",precio:"",articulo:"",isEdit:""}),c=X(o),T=E({get:()=>o.dto===0?"":o.dto,set:e=>{o.dto=e===""?0:Number(e)}}),i=G(),v=H(),{t:x}=J(),n=R([]),F=E(()=>n.value.slice().reverse()),I=E(()=>n.value.length+1),g=R(!1),h=R([]),P=()=>{o.isRe=!o.isRe,r()},_=()=>{o.isIva=!o.isIva,r()},r=()=>{console.log("[PageTable]funcion calcula"),o.total=0;for(const e of n.value)o.total+=e.euros;o.dto<0&&(o.dto=0),o.isIva?o.iva=Number((o.total*(100-o.dto)*.01*.21).toFixed(2)):o.iva=0,o.isRe?o.re=Number((o.total*(100-o.dto)*.01*.052).toFixed(2)):o.re=0,o.total_euros=Number((o.total*(100-o.dto)*.01+o.iva+o.re).toFixed(2))},b=()=>{n.value=new Array,o.total=0,r()},C=()=>{o.add_producto=!0,o.isEdit="",o.cantidad="",o.codigo="",o.precio="",o.articulo=""},A=e=>{o.add_producto=!0,o.cantidad=e.cantidad,o.precio=e.precio,o.codigo=e.codigo,o.articulo=e.articulo,o.isEdit=e.key,o.ante_euro=e.euros},N=e=>{o.add_producto=!1,o.isEdit="",o.cantidad="",o.codigo="",o.precio="",o.articulo="",n.value=n.value.filter(k=>k.codigo!==e),r()},w=()=>{if(g.value=!0,o.isEdit!=""){for(const e of n.value)if(e.key===o.isEdit){e.cantidad=o.cantidad,e.precio=Number(o.precio).toFixed(2),e.codigo=o.codigo,e.articulo=o.articulo,e.euros=Number(o.cantidad)*Number(o.precio);break}o.isEdit=""}else{const e={key:`${I.value}`,cantidad:o.cantidad,codigo:o.codigo,precio:Number(o.precio).toFixed(2),articulo:o.articulo,euros:Number((Number(o.cantidad)*Number(o.precio)).toFixed(2))};n.value.push(e)}o.add_producto=!1,r(),o.cantidad="",o.codigo="",o.precio="",o.articulo="",console.log("[PageTable]producto saved"),g.value=!1},s=()=>{v.state.isVisitor?W().then(e=>{console.log("[PageTable]articulo en base de dato:",e),e.forEach(k=>{h.value.push({value:k.name})})}):Q("articulos").then(e=>{console.log("[PageTable]articulo en FireBase:",e),e.forEach(k=>{h.value.push({value:k.name})})}).catch(e=>{console.error("Error getting data: ",e)})},B=()=>{o.precio=o.precio.replace(/,|，/g,".")},V=()=>{o.precio=o.precio.replace(/[^0-9.,，]/g,"")},L=()=>{o.precio=o.precio.replace(/[^0-9]/g,"")},D=()=>{console.log("[PageTable]funcion pageUpdate"),s(),r(),z()},q=()=>{D(),i.push({name:"pdf",params:{history:0}})},z=()=>{v.commit("saveData",{dataArray:n.value,euroBase:o.total.toFixed(2),dto:o.dto,isRe:o.isRe,isIva:o.isIva}),v.commit("saveFinal",{total:o.total.toFixed(2),dto:o.dto,base:(o.total-o.dto).toFixed(2),iva:o.iva.toFixed(2),re:o.re.toFixed(2),total_final:o.total_euros.toFixed(2)})},M=()=>{z(),i.back()};return K(()=>{console.log("[PageTable]funcion onMounted"),o.dto=v.state.dto,n.value=v.state.dataArray,o.total=v.state.euroBase,o.isRe=v.state.isRe,o.isIva=v.state.isIva,r(),D()}),{...c,t:x,displayDto:T,dataSource:n,reversedDataSource:F,checkIva:_,checkRe:P,calcula:r,goBack:M,addProducto:C,saveProducto:w,deleteProducto:N,editProducto:A,clearTable:b,checkInput:B,validatePrecioInput:V,validateNumberInput:L,confirmLoading:g,goPdf:q,articulo_list:h}}};const U=o=>(eo("data-v-b228816c"),o=o(),ao(),o),so={class:"button-container"},lo={class:"total-header"},io={class:"header-wrap header-bold"},no={class:"header-row"},co={class:"header-left-controls"},ro={class:"header-controls vertical"},uo=U(()=>l("div",{class:"line-break"},null,-1)),po=U(()=>l("div",{class:"line-break"},null,-1)),vo={class:"header-right-info"},_o={class:"large-font"},mo={class:"header-summary"},fo={class:"summary-row"},go={class:"summary-value"},ho={key:0,class:"summary-row"},bo={class:"summary-value"},ko={key:1,class:"summary-row"},yo={class:"summary-value"},Io={key:2,class:"summary-row"},Fo={class:"summary-value"},Po={class:"item-row"},Co=["onClick"],Ao={class:"list-font"},No={class:"articulo-list"},wo={class:"button-container"};function Eo(o,c,T,i,v,x){const n=u("a-button"),F=u("a-input-number"),I=u("a-checkbox"),g=u("PlusOutlined"),h=u("a-list-item"),P=u("a-list"),_=u("a-col"),r=u("a-row"),b=u("a-input"),C=u("a-radio"),A=u("a-radio-group"),N=u("a-popconfirm"),w=u("a-modal");return m(),f(O,null,[l("div",so,[a(n,{onClick:i.goBack,class:"btn-back",size:"large"},{default:t(()=>[p(d(o.$t("back")),1)]),_:1},8,["onClick"]),a(n,{onClick:i.goPdf,class:"btn-next",size:"large"},{default:t(()=>[p(d(o.$t("next")),1)]),_:1},8,["onClick"])]),l("div",lo,[l("div",io,[l("div",no,[l("div",co,[l("div",ro,[a(F,{size:"small",value:i.displayDto,"onUpdate:value":c[0]||(c[0]=s=>i.displayDto=s),onChange:i.calcula,"addon-before":"DTO",min:0,max:99},{default:t(()=>[p("%")]),_:1},8,["value","onChange"]),uo,a(I,{checked:o.isIva,onClick:i.checkIva},{default:t(()=>[p("+21%IVA")]),_:1},8,["checked","onClick"]),po,a(I,{checked:o.isRe,onClick:i.checkRe},{default:t(()=>[p("+5.2%R.E.")]),_:1},8,["checked","onClick"])])]),l("div",vo,[l("div",_o,[l("span",null,d(o.$t("total_euro"))+":"+d(o.total_euros.toFixed(2))+"€",1)]),l("div",mo,[l("div",fo,[l("span",go," Total: "+d(o.total.toFixed(2)),1)]),o.dto>0?(m(),f("div",ho,[l("span",bo,d(o.dto)+"%DTO:-"+d(Number(o.total*.01*o.dto).toFixed(2)),1)])):y("",!0),o.isIva?(m(),f("div",ko,[l("span",yo," +21%IVA: "+d(o.iva.toFixed(2)),1)])):y("",!0),o.isRe?(m(),f("div",Io,[l("span",Fo," +5.2%R.E. "+d(o.re.toFixed(2)),1)])):y("",!0)])])])])]),a(r,null,{default:t(()=>[a(_,{span:24},{default:t(()=>[a(n,{onClick:i.addProducto,class:"btn-add",type:"text",block:""},{icon:t(()=>[a(g,{style:{"font-size":"20px"}})]),_:1},8,["onClick"]),a(P,{class:"a-list","item-layout":"horizontal","data-source":i.reversedDataSource,locale:{emptyText:" "}},{renderItem:t(({item:s})=>[a(h,null,{default:t(()=>[l("div",Po,[l("a",{class:"item-details",onClick:B=>i.editProducto(s)},[l("div",null,[l("div",null,d(s.codigo)+", "+d(s.articulo),1),l("div",null,d(s.cantidad)+" x "+d(Number(s.precio).toFixed(2))+" €",1)]),l("div",Ao,d(Number(s.euros).toFixed(2))+" €",1)],8,Co)])]),_:2},1024)]),_:1},8,["data-source"])]),_:1})]),_:1}),a(w,{visible:o.add_producto,"onUpdate:visible":c[6]||(c[6]=s=>o.add_producto=s),title:"add","confirm-loading":i.confirmLoading,onOk:i.saveProducto},{footer:t(()=>[l("div",wo,[o.isEdit!=""?(m(),S(N,{key:0,title:"Are you sure delete this task?","ok-text":"Yes","cancel-text":"No",onConfirm:c[5]||(c[5]=s=>i.deleteProducto(o.codigo))},{default:t(()=>[o.isEdit!=""?(m(),S(n,{key:0,size:"large",type:"primary",danger:""},{default:t(()=>[p(d(o.$t("delect")),1)]),_:1})):y("",!0)]),_:1})):y("",!0),a(n,{class:$([{"center-button":o.isEdit==""},"btn-normal"]),key:"submit",type:"primary",size:"large",onClick:i.saveProducto},{default:t(()=>[p(d(o.$t("save")),1)]),_:1},8,["class","onClick"])])]),default:t(()=>[a(r,null,{default:t(()=>[a(_,{span:5},{default:t(()=>[p(d(o.$t("cantidad"))+"：",1)]),_:1}),a(_,{span:17},{default:t(()=>[a(b,{value:o.cantidad,"onUpdate:value":c[1]||(c[1]=s=>o.cantidad=s),class:"text-right",spellcheck:"false",onInput:i.validateNumberInput},null,8,["value","onInput"])]),_:1})]),_:1}),a(r,null,{default:t(()=>[a(_,{span:5},{default:t(()=>[p(d(o.$t("precio"))+":",1)]),_:1}),a(_,{span:17},{default:t(()=>[a(b,{value:o.precio,"onUpdate:value":c[2]||(c[2]=s=>o.precio=s),class:"text-right",spellcheck:"false",onBlur:i.checkInput,onInput:i.validatePrecioInput},null,8,["value","onBlur","onInput"])]),_:1})]),_:1}),a(r,null,{default:t(()=>[a(_,{span:5},{default:t(()=>[p(d(o.$t("codigo"))+":",1)]),_:1}),a(_,{span:17},{default:t(()=>[a(b,{value:o.codigo,"onUpdate:value":c[3]||(c[3]=s=>o.codigo=s),class:"text-right",spellcheck:"false"},null,8,["value"])]),_:1})]),_:1}),l("div",No,[a(A,{value:o.articulo,"onUpdate:value":c[4]||(c[4]=s=>o.articulo=s),style:{width:"100%"}},{default:t(()=>[(m(!0),f(O,null,oo(i.articulo_list,s=>(m(),f("div",{key:s.value,class:"articulo-item"},[a(C,{value:s.value},{default:t(()=>[p(d(s.value),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["value"])])]),_:1},8,["visible","confirm-loading","onOk"])],64)}const To=Z(to,[["render",Eo],["__scopeId","data-v-b228816c"]]);export{To as default};
